Successfully updated config!
{'run_dir': 'algorithm/runs/celeba/mcunet-5fps/6b+6w/sgd_qas', 'manual_seed': 0, 'evaluate': False, 'ray_tune': 0, 'resume': 0, 'data_provider': {'dataset': 'image_folder', 'root': '/home/gridsan/agupta2/6.5940/celeba_split', 'resize_scale': 0.08, 'color_aug': 0.4, 'base_batch_size': 64, 'n_worker': 8, 'image_size': 128, 'num_classes': 4}, 'run_config': {'n_epochs': 50, 'base_lr': 0.025, 'bs256_lr': 0.01, 'warmup_epochs': 5, 'warmup_lr': 0, 'lr_schedule_name': 'cosine', 'weight_decay': 0, 'no_wd_keys': ['norm', 'bias'], 'optimizer_name': 'sgd', 'bias_only': 0, 'fc_only': 0, 'fc_lr10': 0, 'eval_per_epochs': 10, 'grid_output': None, 'grid_ckpt_path': None, 'n_block_update': -1}, 'net_config': {'net_name': 'mbv2-w0.35', 'pretrained': False, 'cls_head': 'linear', 'dropout': 0.0, 'mcu_head_type': 'fp'}, 'backward_config': {'enable_backward_config': 0, 'n_bias_update': None, 'n_weight_update': None, 'weight_update_ratio': None, 'weight_select_criteria': 'magnitude+', 'pw1_weight_only': 0, 'manual_weight_idx': None, 'quantize_gradient': 0, 'freeze_fc': 0, 'train_scale': 0}}
 * Getting extra args {'net_name': 'mcunet-5fps', 'bs256_lr': 0.075, 'optimizer_name': 'sgd_scale', 'enable_backward_config': 1, 'n_bias_update': 6, 'n_weight_update': 6}
Successfully updated config!
{'run_dir': 'algorithm/runs/celeba/mcunet-5fps/6b+6w/sgd_qas', 'manual_seed': 0, 'evaluate': False, 'ray_tune': 0, 'resume': 0, 'data_provider': {'dataset': 'image_folder', 'root': '/home/gridsan/agupta2/6.5940/celeba_split', 'resize_scale': 0.08, 'color_aug': 0.4, 'base_batch_size': 64, 'n_worker': 8, 'image_size': 128, 'num_classes': 4}, 'run_config': {'n_epochs': 50, 'base_lr': 0.025, 'bs256_lr': 0.075, 'warmup_epochs': 5, 'warmup_lr': 0, 'lr_schedule_name': 'cosine', 'weight_decay': 0, 'no_wd_keys': ['norm', 'bias'], 'optimizer_name': 'sgd_scale', 'bias_only': 0, 'fc_only': 0, 'fc_lr10': 0, 'eval_per_epochs': 10, 'grid_output': None, 'grid_ckpt_path': None, 'n_block_update': -1}, 'net_config': {'net_name': 'mcunet-5fps', 'pretrained': False, 'cls_head': 'linear', 'dropout': 0.0, 'mcu_head_type': 'fp'}, 'backward_config': {'enable_backward_config': 1, 'n_bias_update': 6, 'n_weight_update': 6, 'weight_update_ratio': None, 'weight_select_criteria': 'magnitude+', 'pw1_weight_only': 0, 'manual_weight_idx': None, 'quantize_gradient': 0, 'freeze_fc': 0, 'train_scale': 0}}
/state/partition1/llgrid/pkg/anaconda/python-ML-2024b/bin/python algorithm/train_cls.py algorithm/configs/transfer.yaml --run_dir algorithm/runs/celeba/mcunet-5fps/6b+6w/sgd_qas --net_name mcunet-5fps --bs256_lr 0.075 --optimizer_name sgd_scale --enable_backward_config 1 --n_bias_update 6 --n_weight_update 6
Experiment started: "algorithm/runs/celeba/mcunet-5fps/6b+6w/sgd_qas".
Using MCU transform (leading to range -128, 127)
Using MCU transform (leading to range -128, 127)
Using MCU transform (leading to range -128, 127)
 * Getting bs256_lr... Overwrite lr from 0.025 to 0.01875 (bs64), total lr 0.01875 (total bs 64)
 * weight decay plan:
0 43
0 43
Getting backward config: {'enable_backward_config': 1, 'n_bias_update': 6, 'weight_update_ratio': [None, None, None, None, None, None], 'weight_select_criteria': 'magnitude+', 'pw1_weight_only': 0, 'manual_weight_idx': [36, 37, 38, 39, 40, 41], 'quantize_gradient': 0, 'freeze_fc': 0, 'train_scale': 0} 
Total convs 42
Train Epoch #1:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #1:   0%|          | 0/1 [00:01<?, ?it/s, loss=1.62, top1=29.7, batch_size=64, img_size=128, lr=0]Train Epoch #1: 100%|██████████| 1/1 [00:01<00:00,  1.33s/it, loss=1.62, top1=29.7, batch_size=64, img_size=128, lr=0]Train Epoch #1: 100%|██████████| 1/1 [00:01<00:00,  1.36s/it, loss=1.62, top1=29.7, batch_size=64, img_size=128, lr=0]
epoch 0: f{'train/top1': 29.6875, 'train/loss': 1.6182197332382202, 'train/lr': 0.00375}
Train Epoch #2:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #2:   0%|          | 0/1 [00:01<?, ?it/s, loss=1.69, top1=23.4, batch_size=64, img_size=128, lr=0.00375]Train Epoch #2: 100%|██████████| 1/1 [00:01<00:00,  1.31s/it, loss=1.69, top1=23.4, batch_size=64, img_size=128, lr=0.00375]Train Epoch #2: 100%|██████████| 1/1 [00:01<00:00,  1.33s/it, loss=1.69, top1=23.4, batch_size=64, img_size=128, lr=0.00375]
epoch 1: f{'train/top1': 23.4375, 'train/loss': 1.686450481414795, 'train/lr': 0.0075}
Train Epoch #3:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #3:   0%|          | 0/1 [00:01<?, ?it/s, loss=1.54, top1=31.2, batch_size=64, img_size=128, lr=0.0075]Train Epoch #3: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=1.54, top1=31.2, batch_size=64, img_size=128, lr=0.0075]Train Epoch #3: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=1.54, top1=31.2, batch_size=64, img_size=128, lr=0.0075]
epoch 2: f{'train/top1': 31.25, 'train/loss': 1.5370736122131348, 'train/lr': 0.01125}
Train Epoch #4:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #4:   0%|          | 0/1 [00:01<?, ?it/s, loss=1.57, top1=21.9, batch_size=64, img_size=128, lr=0.0112]Train Epoch #4: 100%|██████████| 1/1 [00:01<00:00,  1.21s/it, loss=1.57, top1=21.9, batch_size=64, img_size=128, lr=0.0112]Train Epoch #4: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=1.57, top1=21.9, batch_size=64, img_size=128, lr=0.0112]
epoch 3: f{'train/top1': 21.875, 'train/loss': 1.5665780305862427, 'train/lr': 0.015}
Train Epoch #5:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #5:   0%|          | 0/1 [00:01<?, ?it/s, loss=1.39, top1=23.4, batch_size=64, img_size=128, lr=0.015]Train Epoch #5: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=1.39, top1=23.4, batch_size=64, img_size=128, lr=0.015]Train Epoch #5: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=1.39, top1=23.4, batch_size=64, img_size=128, lr=0.015]
epoch 4: f{'train/top1': 23.4375, 'train/loss': 1.3932828903198242, 'train/lr': 0.01875}
Train Epoch #6:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #6:   0%|          | 0/1 [00:01<?, ?it/s, loss=1.34, top1=40.6, batch_size=64, img_size=128, lr=0.0187]Train Epoch #6: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=1.34, top1=40.6, batch_size=64, img_size=128, lr=0.0187]Train Epoch #6: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=1.34, top1=40.6, batch_size=64, img_size=128, lr=0.0187]
epoch 5: f{'train/top1': 40.625, 'train/loss': 1.343082308769226, 'train/lr': 0.018731500579015046}
Train Epoch #7:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #7:   0%|          | 0/1 [00:01<?, ?it/s, loss=1.03, top1=59.4, batch_size=64, img_size=128, lr=0.0187]Train Epoch #7: 100%|██████████| 1/1 [00:01<00:00,  1.19s/it, loss=1.03, top1=59.4, batch_size=64, img_size=128, lr=0.0187]Train Epoch #7: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=1.03, top1=59.4, batch_size=64, img_size=128, lr=0.0187]
epoch 6: f{'train/top1': 59.375, 'train/loss': 1.0265201330184937, 'train/lr': 0.01867607532482323}
Train Epoch #8:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #8:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.954, top1=65.6, batch_size=64, img_size=128, lr=0.0187]Train Epoch #8: 100%|██████████| 1/1 [00:01<00:00,  1.21s/it, loss=0.954, top1=65.6, batch_size=64, img_size=128, lr=0.0187]Train Epoch #8: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.954, top1=65.6, batch_size=64, img_size=128, lr=0.0187]
epoch 7: f{'train/top1': 65.625, 'train/loss': 0.9542898535728455, 'train/lr': 0.01858394297558146}
Train Epoch #9:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #9:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.879, top1=54.7, batch_size=64, img_size=128, lr=0.0186]Train Epoch #9: 100%|██████████| 1/1 [00:01<00:00,  1.17s/it, loss=0.879, top1=54.7, batch_size=64, img_size=128, lr=0.0186]Train Epoch #9: 100%|██████████| 1/1 [00:01<00:00,  1.21s/it, loss=0.879, top1=54.7, batch_size=64, img_size=128, lr=0.0186]
epoch 8: f{'train/top1': 54.6875, 'train/loss': 0.8793667554855347, 'train/lr': 0.018455467135580914}
Train Epoch #10:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #10:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.754, top1=67.2, batch_size=64, img_size=128, lr=0.0185]Train Epoch #10: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=0.754, top1=67.2, batch_size=64, img_size=128, lr=0.0185]Train Epoch #10: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.754, top1=67.2, batch_size=64, img_size=128, lr=0.0185]
epoch 9: f{'train/top1': 67.1875, 'train/loss': 0.7538138031959534, 'train/lr': 0.018291154840267065}
Validate:   0%|          | 0/1 [00:00<?, ?it/s]Validate:   0%|          | 0/1 [00:00<?, ?it/s, loss=0.799, top1=64.3, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.50it/s, loss=0.799, top1=64.3, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.44it/s, loss=0.799, top1=64.3, batch_size=28, img_size=128]
 * New best acc (epoch 9): 64.29
epoch 9: {'val/top1': 64.28571319580078, 'val/loss': 0.799076497554779, 'val/best': 64.28571319580078}
Train Epoch #11:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #11:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.706, top1=73.4, batch_size=64, img_size=128, lr=0.0183]Train Epoch #11: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.706, top1=73.4, batch_size=64, img_size=128, lr=0.0183]Train Epoch #11: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.706, top1=73.4, batch_size=64, img_size=128, lr=0.0183]
epoch 10: f{'train/top1': 73.4375, 'train/loss': 0.7060189843177795, 'train/lr': 0.018091654555202355}
Train Epoch #12:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #12:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.653, top1=76.6, batch_size=64, img_size=128, lr=0.0181]Train Epoch #12: 100%|██████████| 1/1 [00:01<00:00,  1.24s/it, loss=0.653, top1=76.6, batch_size=64, img_size=128, lr=0.0181]Train Epoch #12: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.653, top1=76.6, batch_size=64, img_size=128, lr=0.0181]
epoch 11: f{'train/top1': 76.5625, 'train/loss': 0.6527650952339172, 'train/lr': 0.01785775361686893}
Train Epoch #13:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #13:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.643, top1=67.2, batch_size=64, img_size=128, lr=0.0179]Train Epoch #13: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.643, top1=67.2, batch_size=64, img_size=128, lr=0.0179]Train Epoch #13: 100%|██████████| 1/1 [00:01<00:00,  1.30s/it, loss=0.643, top1=67.2, batch_size=64, img_size=128, lr=0.0179]
epoch 12: f{'train/top1': 67.1875, 'train/loss': 0.6426863670349121, 'train/lr': 0.017590375125411218}
Train Epoch #14:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #14:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.518, top1=85.9, batch_size=64, img_size=128, lr=0.0176]Train Epoch #14: 100%|██████████| 1/1 [00:01<00:00,  1.24s/it, loss=0.518, top1=85.9, batch_size=64, img_size=128, lr=0.0176]Train Epoch #14: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.518, top1=85.9, batch_size=64, img_size=128, lr=0.0176]
epoch 13: f{'train/top1': 85.9375, 'train/loss': 0.5177872180938721, 'train/lr': 0.01729057430158139}
Train Epoch #15:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #15:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.496, top1=78.1, batch_size=64, img_size=128, lr=0.0173]Train Epoch #15: 100%|██████████| 1/1 [00:01<00:00,  1.31s/it, loss=0.496, top1=78.1, batch_size=64, img_size=128, lr=0.0173]Train Epoch #15: 100%|██████████| 1/1 [00:01<00:00,  1.34s/it, loss=0.496, top1=78.1, batch_size=64, img_size=128, lr=0.0173]
epoch 14: f{'train/top1': 78.125, 'train/loss': 0.4955505132675171, 'train/lr': 0.016959534322265133}
Train Epoch #16:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #16:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.639, top1=68.8, batch_size=64, img_size=128, lr=0.017]Train Epoch #16: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.639, top1=68.8, batch_size=64, img_size=128, lr=0.017]Train Epoch #16: 100%|██████████| 1/1 [00:01<00:00,  1.31s/it, loss=0.639, top1=68.8, batch_size=64, img_size=128, lr=0.017]
epoch 15: f{'train/top1': 68.75, 'train/loss': 0.6386107206344604, 'train/lr': 0.016598561651023025}
Train Epoch #17:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #17:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.592, top1=78.1, batch_size=64, img_size=128, lr=0.0166]Train Epoch #17: 100%|██████████| 1/1 [00:01<00:00,  1.24s/it, loss=0.592, top1=78.1, batch_size=64, img_size=128, lr=0.0166]Train Epoch #17: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.592, top1=78.1, batch_size=64, img_size=128, lr=0.0166]
epoch 16: f{'train/top1': 78.125, 'train/loss': 0.5918982625007629, 'train/lr': 0.016209080882075733}
Train Epoch #18:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #18:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.619, top1=79.7, batch_size=64, img_size=128, lr=0.0162]Train Epoch #18: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.619, top1=79.7, batch_size=64, img_size=128, lr=0.0162]Train Epoch #18: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.619, top1=79.7, batch_size=64, img_size=128, lr=0.0162]
epoch 17: f{'train/top1': 79.6875, 'train/loss': 0.619409441947937, 'train/lr': 0.015792629118081457}
Train Epoch #19:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #19:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.486, top1=81.2, batch_size=64, img_size=128, lr=0.0158]Train Epoch #19: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=0.486, top1=81.2, batch_size=64, img_size=128, lr=0.0158]Train Epoch #19: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, loss=0.486, top1=81.2, batch_size=64, img_size=128, lr=0.0158]
epoch 18: f{'train/top1': 81.25, 'train/loss': 0.48596999049186707, 'train/lr': 0.015350849903893966}
Train Epoch #20:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #20:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.553, top1=75, batch_size=64, img_size=128, lr=0.0154]Train Epoch #20: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.553, top1=75, batch_size=64, img_size=128, lr=0.0154]Train Epoch #20: 100%|██████████| 1/1 [00:01<00:00,  1.32s/it, loss=0.553, top1=75, batch_size=64, img_size=128, lr=0.0154]
epoch 19: f{'train/top1': 75.0, 'train/loss': 0.5530630946159363, 'train/lr': 0.014885486740241937}
Validate:   0%|          | 0/1 [00:00<?, ?it/s]Validate:   0%|          | 0/1 [00:00<?, ?it/s, loss=0.48, top1=75, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.77it/s, loss=0.48, top1=75, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.67it/s, loss=0.48, top1=75, batch_size=28, img_size=128]
 * New best acc (epoch 19): 75.00
epoch 19: {'val/top1': 75.0, 'val/loss': 0.4795839488506317, 'val/best': 75.0}
Train Epoch #21:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #21:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.625, top1=75, batch_size=64, img_size=128, lr=0.0149]Train Epoch #21: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, loss=0.625, top1=75, batch_size=64, img_size=128, lr=0.0149]Train Epoch #21: 100%|██████████| 1/1 [00:01<00:00,  1.30s/it, loss=0.625, top1=75, batch_size=64, img_size=128, lr=0.0149]
epoch 20: f{'train/top1': 75.0, 'train/loss': 0.6245226263999939, 'train/lr': 0.014398376202928092}
Train Epoch #22:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #22:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.477, top1=81.2, batch_size=64, img_size=128, lr=0.0144]Train Epoch #22: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.477, top1=81.2, batch_size=64, img_size=128, lr=0.0144]Train Epoch #22: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.477, top1=81.2, batch_size=64, img_size=128, lr=0.0144]
epoch 21: f{'train/top1': 81.25, 'train/loss': 0.4769783020019531, 'train/lr': 0.013891440694703579}
Train Epoch #23:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #23:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.472, top1=81.2, batch_size=64, img_size=128, lr=0.0139]Train Epoch #23: 100%|██████████| 1/1 [00:01<00:00,  1.21s/it, loss=0.472, top1=81.2, batch_size=64, img_size=128, lr=0.0139]Train Epoch #23: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.472, top1=81.2, batch_size=64, img_size=128, lr=0.0139]
epoch 22: f{'train/top1': 81.25, 'train/loss': 0.47200509905815125, 'train/lr': 0.013366680858422556}
Train Epoch #24:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #24:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.396, top1=85.9, batch_size=64, img_size=128, lr=0.0134]Train Epoch #24: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=0.396, top1=85.9, batch_size=64, img_size=128, lr=0.0134]Train Epoch #24: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.396, top1=85.9, batch_size=64, img_size=128, lr=0.0134]
epoch 23: f{'train/top1': 85.9375, 'train/loss': 0.39605915546417236, 'train/lr': 0.012826167681418857}
Train Epoch #25:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #25:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.498, top1=76.6, batch_size=64, img_size=128, lr=0.0128]Train Epoch #25: 100%|██████████| 1/1 [00:01<00:00,  1.24s/it, loss=0.498, top1=76.6, batch_size=64, img_size=128, lr=0.0128]Train Epoch #25: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.498, top1=76.6, batch_size=64, img_size=128, lr=0.0128]
epoch 24: f{'train/top1': 76.5625, 'train/loss': 0.498392790555954, 'train/lr': 0.012272034322265132}
Train Epoch #26:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #26:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.543, top1=81.2, batch_size=64, img_size=128, lr=0.0123]Train Epoch #26: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.543, top1=81.2, batch_size=64, img_size=128, lr=0.0123]Train Epoch #26: 100%|██████████| 1/1 [00:01<00:00,  1.29s/it, loss=0.543, top1=81.2, batch_size=64, img_size=128, lr=0.0123]
epoch 25: f{'train/top1': 81.25, 'train/loss': 0.5425934791564941, 'train/lr': 0.011706467692170512}
Train Epoch #27:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #27:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.404, top1=89.1, batch_size=64, img_size=128, lr=0.0117]Train Epoch #27: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.404, top1=89.1, batch_size=64, img_size=128, lr=0.0117]Train Epoch #27: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.404, top1=89.1, batch_size=64, img_size=128, lr=0.0117]
epoch 26: f{'train/top1': 89.0625, 'train/loss': 0.40414169430732727, 'train/lr': 0.01113169982424117}
Train Epoch #28:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #28:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.497, top1=78.1, batch_size=64, img_size=128, lr=0.0111]Train Epoch #28: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.497, top1=78.1, batch_size=64, img_size=128, lr=0.0111]Train Epoch #28: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.497, top1=78.1, batch_size=64, img_size=128, lr=0.0111]
epoch 27: f{'train/top1': 78.125, 'train/loss': 0.49715834856033325, 'train/lr': 0.010549999064665354}
Train Epoch #29:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #29:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.404, top1=85.9, batch_size=64, img_size=128, lr=0.0105]Train Epoch #29: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.404, top1=85.9, batch_size=64, img_size=128, lr=0.0105]Train Epoch #29: 100%|██████████| 1/1 [00:01<00:00,  1.30s/it, loss=0.404, top1=85.9, batch_size=64, img_size=128, lr=0.0105]
epoch 28: f{'train/top1': 85.9375, 'train/loss': 0.40355515480041504, 'train/lr': 0.009963661120587313}
Train Epoch #30:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #30:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.513, top1=78.1, batch_size=64, img_size=128, lr=0.00996]Train Epoch #30: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.513, top1=78.1, batch_size=64, img_size=128, lr=0.00996]Train Epoch #30: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.513, top1=78.1, batch_size=64, img_size=128, lr=0.00996]
epoch 29: f{'train/top1': 78.125, 'train/loss': 0.5133938789367676, 'train/lr': 0.009375}
Validate:   0%|          | 0/1 [00:00<?, ?it/s]Validate:   0%|          | 0/1 [00:00<?, ?it/s, loss=0.492, top1=85.7, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.73it/s, loss=0.492, top1=85.7, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.64it/s, loss=0.492, top1=85.7, batch_size=28, img_size=128]
 * New best acc (epoch 29): 85.71
epoch 29: {'val/top1': 85.71428680419922, 'val/loss': 0.49157777428627014, 'val/best': 85.71428680419922}
Train Epoch #31:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #31:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.472, top1=78.1, batch_size=64, img_size=128, lr=0.00937]Train Epoch #31: 100%|██████████| 1/1 [00:01<00:00,  1.24s/it, loss=0.472, top1=78.1, batch_size=64, img_size=128, lr=0.00937]Train Epoch #31: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.472, top1=78.1, batch_size=64, img_size=128, lr=0.00937]
epoch 30: f{'train/top1': 78.125, 'train/loss': 0.4721740484237671, 'train/lr': 0.008786338879412686}
Train Epoch #32:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #32:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.429, top1=82.8, batch_size=64, img_size=128, lr=0.00879]Train Epoch #32: 100%|██████████| 1/1 [00:01<00:00,  1.20s/it, loss=0.429, top1=82.8, batch_size=64, img_size=128, lr=0.00879]Train Epoch #32: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=0.429, top1=82.8, batch_size=64, img_size=128, lr=0.00879]
epoch 31: f{'train/top1': 82.8125, 'train/loss': 0.4292200803756714, 'train/lr': 0.008200000935334649}
Train Epoch #33:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #33:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.453, top1=76.6, batch_size=64, img_size=128, lr=0.0082]Train Epoch #33: 100%|██████████| 1/1 [00:01<00:00,  1.35s/it, loss=0.453, top1=76.6, batch_size=64, img_size=128, lr=0.0082]Train Epoch #33: 100%|██████████| 1/1 [00:01<00:00,  1.39s/it, loss=0.453, top1=76.6, batch_size=64, img_size=128, lr=0.0082]
epoch 32: f{'train/top1': 76.5625, 'train/loss': 0.4527686536312103, 'train/lr': 0.007618300175758832}
Train Epoch #34:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #34:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.498, top1=79.7, batch_size=64, img_size=128, lr=0.00762]Train Epoch #34: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=0.498, top1=79.7, batch_size=64, img_size=128, lr=0.00762]Train Epoch #34: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, loss=0.498, top1=79.7, batch_size=64, img_size=128, lr=0.00762]
epoch 33: f{'train/top1': 79.6875, 'train/loss': 0.4983687400817871, 'train/lr': 0.007043532307829486}
Train Epoch #35:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #35:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.472, top1=78.1, batch_size=64, img_size=128, lr=0.00704]Train Epoch #35: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.472, top1=78.1, batch_size=64, img_size=128, lr=0.00704]Train Epoch #35: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.472, top1=78.1, batch_size=64, img_size=128, lr=0.00704]
epoch 34: f{'train/top1': 78.125, 'train/loss': 0.4724658727645874, 'train/lr': 0.00647796567773487}
Train Epoch #36:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #36:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.494, top1=78.1, batch_size=64, img_size=128, lr=0.00648]Train Epoch #36: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=0.494, top1=78.1, batch_size=64, img_size=128, lr=0.00648]Train Epoch #36: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, loss=0.494, top1=78.1, batch_size=64, img_size=128, lr=0.00648]
epoch 35: f{'train/top1': 78.125, 'train/loss': 0.4939555525779724, 'train/lr': 0.005923832318581146}
Train Epoch #37:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #37:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.369, top1=89.1, batch_size=64, img_size=128, lr=0.00592]Train Epoch #37: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.369, top1=89.1, batch_size=64, img_size=128, lr=0.00592]Train Epoch #37: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.369, top1=89.1, batch_size=64, img_size=128, lr=0.00592]
epoch 36: f{'train/top1': 89.0625, 'train/loss': 0.3689035177230835, 'train/lr': 0.0053833191415774435}
Train Epoch #38:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #38:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.44, top1=78.1, batch_size=64, img_size=128, lr=0.00538]Train Epoch #38: 100%|██████████| 1/1 [00:01<00:00,  1.18s/it, loss=0.44, top1=78.1, batch_size=64, img_size=128, lr=0.00538]Train Epoch #38: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.44, top1=78.1, batch_size=64, img_size=128, lr=0.00538]
epoch 37: f{'train/top1': 78.125, 'train/loss': 0.4400519132614136, 'train/lr': 0.004858559305296418}
Train Epoch #39:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #39:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.419, top1=84.4, batch_size=64, img_size=128, lr=0.00486]Train Epoch #39: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.419, top1=84.4, batch_size=64, img_size=128, lr=0.00486]Train Epoch #39: 100%|██████████| 1/1 [00:01<00:00,  1.29s/it, loss=0.419, top1=84.4, batch_size=64, img_size=128, lr=0.00486]
epoch 38: f{'train/top1': 84.375, 'train/loss': 0.41911929845809937, 'train/lr': 0.004351623797071904}
Train Epoch #40:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #40:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.504, top1=81.2, batch_size=64, img_size=128, lr=0.00435]Train Epoch #40: 100%|██████████| 1/1 [00:01<00:00,  1.24s/it, loss=0.504, top1=81.2, batch_size=64, img_size=128, lr=0.00435]Train Epoch #40: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.504, top1=81.2, batch_size=64, img_size=128, lr=0.00435]
epoch 39: f{'train/top1': 81.25, 'train/loss': 0.5043351054191589, 'train/lr': 0.0038645132597580653}
Validate:   0%|          | 0/1 [00:00<?, ?it/s]Validate:   0%|          | 0/1 [00:00<?, ?it/s, loss=0.419, top1=85.7, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.80it/s, loss=0.419, top1=85.7, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.72it/s, loss=0.419, top1=85.7, batch_size=28, img_size=128]
epoch 39: {'val/top1': 85.71428680419922, 'val/loss': 0.41858601570129395, 'val/best': 85.71428680419922}
Train Epoch #41:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #41:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.423, top1=82.8, batch_size=64, img_size=128, lr=0.00386]Train Epoch #41: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.423, top1=82.8, batch_size=64, img_size=128, lr=0.00386]Train Epoch #41: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.423, top1=82.8, batch_size=64, img_size=128, lr=0.00386]
epoch 40: f{'train/top1': 82.8125, 'train/loss': 0.42310914397239685, 'train/lr': 0.0033991500961060334}
Train Epoch #42:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #42:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.472, top1=81.2, batch_size=64, img_size=128, lr=0.0034]Train Epoch #42: 100%|██████████| 1/1 [00:01<00:00,  1.24s/it, loss=0.472, top1=81.2, batch_size=64, img_size=128, lr=0.0034]Train Epoch #42: 100%|██████████| 1/1 [00:01<00:00,  1.29s/it, loss=0.472, top1=81.2, batch_size=64, img_size=128, lr=0.0034]
epoch 41: f{'train/top1': 81.25, 'train/loss': 0.4722833037376404, 'train/lr': 0.002957370881918543}
Train Epoch #43:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #43:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.371, top1=87.5, batch_size=64, img_size=128, lr=0.00296]Train Epoch #43: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.371, top1=87.5, batch_size=64, img_size=128, lr=0.00296]Train Epoch #43: 100%|██████████| 1/1 [00:01<00:00,  1.29s/it, loss=0.371, top1=87.5, batch_size=64, img_size=128, lr=0.00296]
epoch 42: f{'train/top1': 87.5, 'train/loss': 0.37084585428237915, 'train/lr': 0.002540919117924269}
Train Epoch #44:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #44:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.488, top1=82.8, batch_size=64, img_size=128, lr=0.00254]Train Epoch #44: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.488, top1=82.8, batch_size=64, img_size=128, lr=0.00254]Train Epoch #44: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, loss=0.488, top1=82.8, batch_size=64, img_size=128, lr=0.00254]
epoch 43: f{'train/top1': 82.8125, 'train/loss': 0.48756471276283264, 'train/lr': 0.0021514383489769765}
Train Epoch #45:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #45:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.357, top1=87.5, batch_size=64, img_size=128, lr=0.00215]Train Epoch #45: 100%|██████████| 1/1 [00:01<00:00,  1.26s/it, loss=0.357, top1=87.5, batch_size=64, img_size=128, lr=0.00215]Train Epoch #45: 100%|██████████| 1/1 [00:01<00:00,  1.30s/it, loss=0.357, top1=87.5, batch_size=64, img_size=128, lr=0.00215]
epoch 44: f{'train/top1': 87.5, 'train/loss': 0.35732901096343994, 'train/lr': 0.0017904656777348686}
Train Epoch #46:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #46:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.446, top1=81.2, batch_size=64, img_size=128, lr=0.00179]Train Epoch #46: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=0.446, top1=81.2, batch_size=64, img_size=128, lr=0.00179]Train Epoch #46: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.446, top1=81.2, batch_size=64, img_size=128, lr=0.00179]
epoch 45: f{'train/top1': 81.25, 'train/loss': 0.44562584161758423, 'train/lr': 0.0014594256984186108}
Train Epoch #47:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #47:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.444, top1=79.7, batch_size=64, img_size=128, lr=0.00146]Train Epoch #47: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.444, top1=79.7, batch_size=64, img_size=128, lr=0.00146]Train Epoch #47: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.444, top1=79.7, batch_size=64, img_size=128, lr=0.00146]
epoch 46: f{'train/top1': 79.6875, 'train/loss': 0.44397199153900146, 'train/lr': 0.001159624874588779}
Train Epoch #48:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #48:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.258, top1=90.6, batch_size=64, img_size=128, lr=0.00116]Train Epoch #48: 100%|██████████| 1/1 [00:01<00:00,  1.21s/it, loss=0.258, top1=90.6, batch_size=64, img_size=128, lr=0.00116]Train Epoch #48: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.258, top1=90.6, batch_size=64, img_size=128, lr=0.00116]
epoch 47: f{'train/top1': 90.625, 'train/loss': 0.2581624388694763, 'train/lr': 0.0008922463831310685}
Train Epoch #49:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #49:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.447, top1=82.8, batch_size=64, img_size=128, lr=0.000892]Train Epoch #49: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.447, top1=82.8, batch_size=64, img_size=128, lr=0.000892]Train Epoch #49: 100%|██████████| 1/1 [00:01<00:00,  1.28s/it, loss=0.447, top1=82.8, batch_size=64, img_size=128, lr=0.000892]
epoch 48: f{'train/top1': 82.8125, 'train/loss': 0.4473457634449005, 'train/lr': 0.0006583454447976436}
Train Epoch #50:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #50:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.399, top1=82.8, batch_size=64, img_size=128, lr=0.000658]Train Epoch #50: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.399, top1=82.8, batch_size=64, img_size=128, lr=0.000658]Train Epoch #50: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.399, top1=82.8, batch_size=64, img_size=128, lr=0.000658]
epoch 49: f{'train/top1': 82.8125, 'train/loss': 0.3991512656211853, 'train/lr': 0.00045884515973293563}
Validate:   0%|          | 0/1 [00:00<?, ?it/s]Validate:   0%|          | 0/1 [00:00<?, ?it/s, loss=0.481, top1=82.1, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.74it/s, loss=0.481, top1=82.1, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.64it/s, loss=0.481, top1=82.1, batch_size=28, img_size=128]
epoch 49: {'val/top1': 82.14286041259766, 'val/loss': 0.4813547730445862, 'val/best': 85.71428680419922}
Train Epoch #51:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #51:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.352, top1=81.2, batch_size=64, img_size=128, lr=0.000459]Train Epoch #51: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=0.352, top1=81.2, batch_size=64, img_size=128, lr=0.000459]Train Epoch #51: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, loss=0.352, top1=81.2, batch_size=64, img_size=128, lr=0.000459]
epoch 50: f{'train/top1': 81.25, 'train/loss': 0.35201460123062134, 'train/lr': 0.00029453286441908467}
Train Epoch #52:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #52:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.389, top1=84.4, batch_size=64, img_size=128, lr=0.000295]Train Epoch #52: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it, loss=0.389, top1=84.4, batch_size=64, img_size=128, lr=0.000295]Train Epoch #52: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it, loss=0.389, top1=84.4, batch_size=64, img_size=128, lr=0.000295]
epoch 51: f{'train/top1': 84.375, 'train/loss': 0.3892360031604767, 'train/lr': 0.00016605702441854322}
Train Epoch #53:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #53:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.408, top1=85.9, batch_size=64, img_size=128, lr=0.000166]Train Epoch #53: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=0.408, top1=85.9, batch_size=64, img_size=128, lr=0.000166]Train Epoch #53: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, loss=0.408, top1=85.9, batch_size=64, img_size=128, lr=0.000166]
epoch 52: f{'train/top1': 85.9375, 'train/loss': 0.40757104754447937, 'train/lr': 7.392467517677096e-05}
Train Epoch #54:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #54:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.399, top1=87.5, batch_size=64, img_size=128, lr=7.39e-5]Train Epoch #54: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it, loss=0.399, top1=87.5, batch_size=64, img_size=128, lr=7.39e-5]Train Epoch #54: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, loss=0.399, top1=87.5, batch_size=64, img_size=128, lr=7.39e-5]
epoch 53: f{'train/top1': 87.5, 'train/loss': 0.39924871921539307, 'train/lr': 1.8499420984954135e-05}
Train Epoch #55:   0%|          | 0/1 [00:00<?, ?it/s]Train Epoch #55:   0%|          | 0/1 [00:01<?, ?it/s, loss=0.47, top1=85.9, batch_size=64, img_size=128, lr=1.85e-5]Train Epoch #55: 100%|██████████| 1/1 [00:01<00:00,  1.24s/it, loss=0.47, top1=85.9, batch_size=64, img_size=128, lr=1.85e-5]Train Epoch #55: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, loss=0.47, top1=85.9, batch_size=64, img_size=128, lr=1.85e-5]
epoch 54: f{'train/top1': 85.9375, 'train/loss': 0.4698975384235382, 'train/lr': 0.0}
Validate:   0%|          | 0/1 [00:00<?, ?it/s]Validate:   0%|          | 0/1 [00:00<?, ?it/s, loss=0.48, top1=82.1, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.68it/s, loss=0.48, top1=82.1, batch_size=28, img_size=128]Validate: 100%|██████████| 1/1 [00:00<00:00,  1.60it/s, loss=0.48, top1=82.1, batch_size=28, img_size=128]
epoch 54: {'val/top1': 82.14286041259766, 'val/loss': 0.4804341495037079, 'val/best': 85.71428680419922}
